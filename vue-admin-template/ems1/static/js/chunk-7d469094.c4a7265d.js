(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d469094"],{"0ba9":function(t,e,a){},"163d":function(t,e,a){"use strict";var s=a("e7ad"),i=a("e042"),r=a("75c4"),n=a("1e5b"),c=a("94b3"),o=a("238a"),l=a("2ea2").f,d=a("dcb7").f,u=a("064e").f,v=a("777a").trim,p="Number",_=s[p],f=_,m=_.prototype,h=r(a("e005")(m))==p,b="trim"in String.prototype,y=function(t){var e=c(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():v(e,3);var a,s,i,r=e.charCodeAt(0);if(43===r||45===r){if(a=e.charCodeAt(2),88===a||120===a)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:s=2,i=49;break;case 79:case 111:s=8,i=55;break;default:return+e}for(var n,o=e.slice(2),l=0,d=o.length;l<d;l++)if(n=o.charCodeAt(l),n<48||n>i)return NaN;return parseInt(o,s)}}return+e};if(!_(" 0o1")||!_("0b1")||_("+0x1")){_=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof _&&(h?o((function(){m.valueOf.call(a)})):r(a)!=p)?n(new f(y(e)),a,_):y(e)};for(var k,C=a("149f")?l(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),D=0;C.length>D;D++)i(f,k=C[D])&&!i(_,k)&&u(_,k,d(f,k));_.prototype=m,m.constructor=_,a("bf16")(s,p,_)}},"31a8":function(t,e,a){"use strict";var s=a("c67e"),i=a.n(s);i.a},"4c37":function(t,e,a){"use strict";var s=a("ff43"),i=a.n(s);i.a},"539d":function(t,e,a){"use strict";var s=a("c4b5"),i=a.n(s);i.a},"5bbb":function(t,e,a){"use strict";var s=a("9e37"),i=a.n(s);i.a},"6b26":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=0;function i(){s=Date.now()}function r(){console.log(Date.now()-s+"ms")}function n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]}function c(t){return Array.isArray(t)?t:[t]}function o(t,e){var a=t.getAttribute("data-print-class");a&&t.classList.add(a);var s=t.getAttribute("data-print-style")||"",i="";if(!0===e)i=window.getComputedStyle(t).cssText;else if(Array.isArray(e)){var r=window.getComputedStyle(t);i=e.map((function(t){var e=r.getPropertyValue(t);return e?t+": "+e+";":""})).filter(Boolean).join(" ")}return i+s}e.timeStart=i,e.timeEnd=r,e.noop=n,e.ensureArray=c,e.getStyles=o;var l=["INPUT","TEXTAREA","SELECT"];function d(t){return"SELECT"===t.tagName}function u(t,e,a){void 0===a&&(a=[]);var s=a.includes(t.tagName)?"":o(t,e);if(l.includes(t.tagName)){var i=document.createElement("pre");i.innerHTML=d(t)?t.options[t.selectedIndex].text:t.value,i.className=t.className,s&&i.setAttribute("style",s),t.parentNode.replaceChild(i,t)}else if(s&&t.setAttribute("style",s),t.children&&t.children.length)for(var r=t.children,n=r.length,c=0;c<n;c++)u(r[c],e,a)}function v(t,e){var a=t.document,s=a.head||a.querySelector("head");e.forEach((function(t){var e=a.createElement("style");e.type="text/css",e.innerHTML=t.content,t.media&&(e.media=t.media),s.appendChild(e)}))}function p(t){return new Promise((function(e){var a=t.getAttribute("src");!a||a.startsWith("data:image")?e():(t.onerror=function(){return e()},t.onload=function(){return e()})}))}e.loopStyles=u,e.injectStyles=v,e.resolveImage=p},"777a":function(t,e,a){var s=a("e46b"),i=a("f6b4"),r=a("238a"),n=a("9769"),c="["+n+"]",o="​",l=RegExp("^"+c+c+"*"),d=RegExp(c+c+"*$"),u=function(t,e,a){var i={},c=r((function(){return!!n[t]()||o[t]()!=o})),l=i[t]=c?e(v):n[t];a&&(i[a]=l),s(s.P+s.F*c,"String",i)},v=u.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(d,"")),t};t.exports=u},"77dc":function(t,e,a){},"806f":function(t,e,a){"use strict";var s=a("fe2a"),i=a.n(s);i.a},"853f":function(t,e,a){"use strict";var s=a("77dc"),i=a.n(s);i.a},"8d01":function(t,e,a){"use strict";var s=a("0ba9"),i=a.n(s);i.a},"8e5f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail-con"},["个人求救"==t.detail.taskInfo.eventType?a("DetailTablePersonal",{attrs:{dataSource:t.detail}}):t._e(),t._v(" "),"群体事件"==t.detail.taskInfo.eventType?a("DetailTableGroup",{attrs:{dataSource:t.detail}}):t._e(),t._v(" "),"0"===t.detail.taskInfo.status?a("ManageTable",{ref:"ManageTable",attrs:{taskInfo:t.detail.taskInfo,dispatchRecordList:t.detail.dispatchRecordList}}):t._e(),t._v(" "),"-1"===t.detail.taskInfo.status?a("ManageTableReject",{ref:"ManageTableReject",attrs:{taskInfo:t.detail.taskInfo}}):t._e(),t._v(" "),"-2"===t.detail.taskInfo.status?a("ManageTableCancel",{ref:"ManageTableReject",attrs:{taskInfo:t.detail.taskInfo}}):t._e(),t._v(" "),"1"===t.detail.taskInfo.status?a("ManageTableAccept",{ref:"ManageTableAccept",attrs:{taskInfo:t.detail.taskInfo,dispatchRecordList:t.detail.dispatchRecordList,openSuccessModal:t.openSuccessModal}}):t._e(),t._v(" "),"2"===t.detail.taskInfo.status?a("ManageTableComplete",{ref:"ManageTableAccept",attrs:{taskInfo:t.detail.taskInfo,dispatchRecordList:t.detail.dispatchRecordList,openSuccessModal:t.openSuccessModal}}):t._e(),t._v(" "),"0"===t.detail.taskInfo.status?a("div",{staticClass:"footer-btn-row"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:t.reject}},[t._v("拒绝派车")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submit}},[t._v("确定派单")])],1):t._e(),t._v(" "),"-1"===t.detail.taskInfo.status?a("div",{staticClass:"footer-btn-row"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")])],1):t._e(),t._v(" "),"-2"===t.detail.taskInfo.status?a("div",{staticClass:"footer-btn-row"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")])],1):t._e(),t._v(" "),"2"===t.detail.taskInfo.status?a("div",{staticClass:"footer-btn-row"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")])],1):t._e(),t._v(" "),"1"===t.detail.taskInfo.status?a("div",{staticClass:"footer-btn-row"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")]),t._v(" "),t.detail.taskInfo.canArchive?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.archive}},[t._v("归档")]):t._e()],1):t._e(),t._v(" "),a("SuccessModal",{ref:"SuccessModal",attrs:{init:t.init}})],1)},i=[],r=(a("5ab2"),a("e10e"),a("6d57"),a("06a2"),a("88d6")),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"info-table-wrapper"},[s("table",{staticClass:"info-table"},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("tr",[s("td",{staticClass:"key"},[t._v("急救编号：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.taskNo))]),t._v(" "),s("td",{staticClass:"key"},[t._v("求救类型：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.eventType))]),t._v(" "),s("td",{staticClass:"key"},[t._v("危重等级：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dangerLevel))]),t._v(" "),s("td",{staticClass:"key"},[t._v("发单时间：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dispatchTime))])]),t._v(" "),s("tr",[s("td",{staticClass:"key"},[t._v("病人姓名：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.patientName))]),t._v(" "),s("td",{staticClass:"key"},[t._v("性别")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.sex))]),t._v(" "),s("td",{staticClass:"key"},[t._v("年龄：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.age))]),t._v(" "),s("td",{staticClass:"key"},[t._v("身份：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.personDesc))])]),t._v(" "),s("tr",[s("td",{staticClass:"key"},[t._v("联系人：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.contactName))]),t._v(" "),s("td",{staticClass:"key"},[t._v("电话：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.contactPhone))]),t._v(" "),s("td",{staticClass:"key"},[t._v("地址：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"3"}},[t._v(t._s(t.taskInfo.eventLocation))])]),t._v(" "),s("tr",[s("td",{staticClass:"key"},[t._v("主诉：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"3"}},[t._v("\n        "+t._s(t.taskInfo.complaints)+"\n      ")]),t._v(" "),s("td",{staticClass:"key"},[t._v("求救方式：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.askHelpType))]),t._v(" "),s("td",{staticClass:"key"},[t._v("建议派车数量：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.proposeCarNumber))])])]),t._v(" "),s("img",{staticClass:"status-img",attrs:{src:a("c0d8")("./"+t.imgMap[t.taskInfo.status]+".png"),alt:""}})])},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"15%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"10%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"15%"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{attrs:{colspan:"8"}},[t._v("求救信息")])])}],o={props:{dataSource:{type:Object,default:function(){}}},data:function(){return{imgMap:{0:"未受理",1:"受理中",2:"已完成","-1":"不受理","-2":"已取消"}}},computed:{taskInfo:function(){return this.dataSource.taskInfo||{}},dispatchRecordList:function(){return this.dataSource.dispatchRecordList||[]}},methods:{},components:{}},l=o,d=a("4023"),u=Object(d["a"])(l,n,c,!1,null,"0d7952b8",null),v=u.exports,p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"info-table-wrapper"},[s("table",{staticClass:"info-table"},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("tr",[s("td",{staticClass:"key"},[t._v("急救编号：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.taskNo))]),t._v(" "),s("td",{staticClass:"key"},[t._v("求救类型：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.eventType))]),t._v(" "),s("td",{staticClass:"key"},[t._v("事件等级：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dangerLevel))]),t._v(" "),s("td",{staticClass:"key"},[t._v("发单时间：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dispatchTime))])]),t._v(" "),s("tr",[s("td",{staticClass:"key"},[t._v("联系人：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.contactName))]),t._v(" "),s("td",{staticClass:"key"},[t._v("电话：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.contactPhone))]),t._v(" "),s("td",{staticClass:"key"},[t._v("地址：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"3"}},[t._v(t._s(t.taskInfo.eventLocation))])]),t._v(" "),s("tr",[s("td",{staticClass:"key"},[t._v("事件描述：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"3"}},[t._v("\n        "+t._s(t.taskInfo.complaints)+"\n      ")]),t._v(" "),s("td",{staticClass:"key"},[t._v("求救方式：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.askHelpType))]),t._v(" "),s("td",{staticClass:"key"},[t._v("建议派车数量：")]),t._v(" "),s("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.proposeCarNumber))])])]),t._v(" "),s("img",{staticClass:"status-img",attrs:{src:a("c0d8")("./"+t.imgMap[t.taskInfo.status]+".png"),alt:""}})])},_=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"15%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"10%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"15%"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{attrs:{colspan:"8"}},[t._v("求救信息")])])}],f={props:{dataSource:{type:Object,default:function(){}}},data:function(){return{imgMap:{0:"未受理",1:"受理中",2:"已完成","-1":"不受理","-2":"已取消"}}},computed:{taskInfo:function(){return this.dataSource.taskInfo||{}},dispatchRecordList:function(){return this.dataSource.dispatchRecordList||[]}},methods:{},components:{}},m=f,h=Object(d["a"])(m,p,_,!1,null,"71c4bfca",null),b=h.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"info-table-wrapper"},[a("table",{staticClass:"info-table"},[t._m(0),t._v(" "),a("tr",[a("th",{attrs:{colspan:"8"}},[t._v(t._s(t.taskInfo.taskNo))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("急救单位：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"7"}},[t._v(t._s(t.taskInfo.departureHospital))])]),t._v(" "),t._l(t.dispatchRecordList,(function(e,s){return a("NoAcceptPart",{key:s,attrs:{item:e,index:s,carDict:t.carDict,doctorDict:t.doctorDict,nurseDict:t.nurseDict,driverDict:t.driverDict,dispatcherDict:t.dispatcherDict,delCar:t.delCar,partMode:"noAccept"}})}))],2),t._v(" "),a("el-button",{staticClass:"add-car",attrs:{type:"primary",size:"small"},on:{click:t.addCar}},[t._v("新增车辆")])],1)},k=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}})])}],C=(a("309f"),a("0b53"),a("ec25"),a("cc57"),a("2b45"),a("e697"),a("2934")),D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tbody",[s("tr",{key:t.index},[s("td",{staticClass:"key carName"},[t._v("车辆"+t._s(t.index+1)+"：\n      "),t.item.abnormalMessage?s("el-popover",{attrs:{placement:"right-start",title:"突发状况",width:"120",trigger:"hover",content:t.item.abnormalMessage.title,"popper-class":"car-waring-popover"}},[s("img",{staticClass:"warning-icon",attrs:{slot:"reference",src:a("e2e7"),alt:""},slot:"reference"})]):t._e(),t._v(" "),0!==t.index&&"0"===t.item.status?s("i",{staticClass:"el-icon-close",on:{click:function(e){return t.delCar(t.item,t.index)}}}):t._e()],1),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.carNo))]):s("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:t.changeCar},model:{value:t.item.carNo,callback:function(e){t.$set(t.item,"carNo",e)},expression:"item.carNo"}},t._l(t.carDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.carNo,label:t.carNo}})})),1)],1),t._v(" "),s("td",{staticClass:"key"},[t._v("车内电话：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.driverPhone))]):s("el-input",{attrs:{size:"mini"},model:{value:t.item.driverPhone,callback:function(e){t.$set(t.item,"driverPhone",e)},expression:"item.driverPhone"}})],1),t._v(" "),s("td",{staticClass:"key"},[t._v("司机：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.driverName))]):s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.item.driverNo,callback:function(e){t.$set(t.item,"driverNo",e)},expression:"item.driverNo"}},t._l(t.driverAllDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.empNo,label:t.empName}})})),1)],1),t._v(" "),s("td",{staticClass:"key"},[t._v("调度员：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.dispatchEmpName))]):s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.item.dispatchEmpNo,callback:function(e){t.$set(t.item,"dispatchEmpNo",e)},expression:"item.dispatchEmpNo"}},t._l(t.dispatcherDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.empNo,label:t.empName}})})),1)],1)]),t._v(" "),s("tr",{key:t.index+"two"},[s("td",{staticClass:"key"},[t._v("出诊医生：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"3"}},["view"==t.item.mode?s("span",[t._v(t._s(t.item.doctorList.map((function(t){return t.empName})).join("，")))]):s("el-select",{staticClass:"block-select",attrs:{placeholder:"请选择",size:"mini",multiple:""},model:{value:t.item.doctorNoList,callback:function(e){t.$set(t.item,"doctorNoList",e)},expression:"item.doctorNoList"}},t._l(t.doctorAllDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.empNo,label:t.empName}})})),1)],1),t._v(" "),s("td",{staticClass:"key"},[t._v("出诊护士：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"3"}},["view"==t.item.mode?s("span",[t._v(t._s(t.item.nurseList.map((function(t){return t.empName})).join("，")))]):s("el-select",{staticClass:"block-select",attrs:{placeholder:"请选择",size:"mini",multiple:""},model:{value:t.item.nurseNoList,callback:function(e){t.$set(t.item,"nurseNoList",e)},expression:"item.nurseNoList"}},t._l(t.nurseAllDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.empNo,label:t.empName}})})),1)],1)]),t._v(" "),"noAccept"!==t.partMode?s("tr",{key:t.index+"four"},[s("td",{staticClass:"key"},[t._v("状态：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"7"}},[s("div",{staticClass:"status-td"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.nodeName))]):t._e(),t._v(" "),s("div",{staticClass:"block"}),t._v(" "),"edit"==t.item.mode?s("el-button",{attrs:{type:"text"},on:{click:function(e){t.item.mode="view"}}},[t._v("取消编辑")]):t._e(),t._v(" "),"view"==t.item.mode?s("el-button",{attrs:{type:"text"},on:{click:function(e){t.item.mode="edit"}}},[t._v("编辑")]):s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.savePart(t.item)}}},[t._v("保存")]),t._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onPrint(t.item)}}},[t._v("打印出车单")]),t._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.cancelDispatch(t.item,t.index)}}},[t._v("取消任务")]),t._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.openDispatchDetailModal(t.item,t.index)}}},[t._v("进度跟踪")])],1)])]):t._e()])},N=[],g=a("5c62"),w=(a("163d"),{props:{item:{type:Object,default:function(){return{}}},index:{type:Number,default:0},carDict:{type:Array,default:function(){return[]}},doctorDict:{type:Array,default:function(){return[]}},nurseDict:{type:Array,default:function(){return[]}},driverDict:{type:Array,default:function(){return[]}},dispatcherDict:{type:Array,default:function(){return[]}},savePart:{type:Function,default:function(){}},delPart:{type:Function,default:function(){}},onPrint:{type:Function,default:function(){}},openDispatchDetailModal:{type:Function,default:function(){}},cancelDispatch:{type:Function,default:function(){}},partMode:{type:String,default:""},delCar:{type:Function,default:function(){}}},data:function(){return{}},computed:{nurseAllDict:function(){for(var t=this,e=Object(g["a"])(this.nurseDict),a=function(a){e.find((function(e){return e.empNo==t.item.nurseList[a].empNo}))||e.push(t.item.nurseList[a])},s=0;s<this.item.nurseList.length;s++)a(s);return e},doctorAllDict:function(){for(var t=this,e=Object(g["a"])(this.doctorDict),a=function(a){e.find((function(e){return e.empNo==t.item.doctorList[a].empNo}))||e.push(t.item.doctorList[a])},s=0;s<this.item.doctorList.length;s++)a(s);return e},driverAllDict:function(){return this.item.driverDict}},watch:{driverDict:{handler:function(){var t=this;this.item.driverNo&&!this.driverDict.find((function(e){return e.empNo===t.item.driverNo}))?this.item.driverDict=[].concat(Object(g["a"])(this.driverDict),[{empName:this.item.driverName,empNo:this.item.driverNo}]):this.item.driverDict=Object(g["a"])(this.driverDict)},immediate:!0}},methods:{getCarInfo:function(t){return this.carDict.find((function(e){return e.carNo==t}))},changeCar:function(t){this.item.driverPhone=this.getCarInfo(t).carPhone}},components:{}}),I=w,O=(a("853f"),Object(d["a"])(I,D,N,!1,null,"7ce7666a",null)),j=O.exports;function T(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function x(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?T(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function L(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=P(t))){var e=0,a=function(){};return{s:a,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i,r=!0,n=!1;return{s:function(){s=t[Symbol.iterator]()},n:function(){var t=s.next();return r=t.done,t},e:function(t){n=!0,i=t},f:function(){try{r||null==s.return||s.return()}finally{if(n)throw i}}}}function P(t,e){if(t){if("string"===typeof t)return S(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?S(t,e):void 0}}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}var M={props:{taskInfo:{type:Object,default:function(){return{}}},dispatchRecordList:{type:Array,default:function(){return[]}}},data:function(){return{carDict:[],carNo:null,doctorDict:[],nurseDict:[],driverDict:[],dispatcherDict:[],doctorList:[],nurseList:[]}},methods:{getUserInfo:function(t,e){return e.find((function(e){return e.empNo==t}))},mergeData:function(){var t,e=this,a=[],s=L(this.dispatchRecordList);try{for(s.s();!(t=s.n()).done;){var i=t.value,r=this.getUserInfo(i.driverNo,this.driverDict)||{},n=this.getUserInfo(i.dispatchEmpNo,this.dispatcherDict)||{};a.push(x(x({},i),{},{taskNo:this.$route.query.taskNo,carNo:i.carNo,driverNo:r.empNo,driverName:r.empName,dispatchEmpNo:n.empNo,dispatchEmpName:n.empName,driverPhone:i.driverPhone,nurseList:i.nurseNoList.map((function(t){return e.getUserInfo(t,e.nurseDict)})),doctorList:i.doctorNoList.map((function(t){return e.getUserInfo(t,e.doctorDict)}))}))}}catch(c){s.e(c)}finally{s.f()}return a},addCar:function(){this.dispatchRecordList.push({taskNo:"",carNo:"",driverNo:"",driverName:"",driverPhone:"",nurseList:[],doctorList:[],doctorNoList:[],nurseNoList:[],mode:"edit",status:"0"})},delCar:function(t,e){var a=this;t.dispatchId?this.$confirm("是否删除此调度?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(C["g"])(t.dispatchId).then((function(t){a.openSuccessModal("删除此调度成功~")}))})):this.dispatchRecordList.splice(e,1)}},created:function(){var t=this;Object(C["r"])().then((function(e){t.carDict=e.data.filter((function(t){return t.normal&&!t.inTask}))})),Object(C["m"])({userType:"doctor",inTask:!1,normal:!0}).then((function(e){t.doctorDict=e.data})),Object(C["m"])({userType:"nurse",inTask:!1,normal:!0}).then((function(e){t.nurseDict=e.data})),Object(C["m"])({userType:"driver",inTask:!1,normal:!0}).then((function(e){t.driverDict=e.data})),Object(C["m"])({userType:"dispatcher",inTask:!1,normal:!0}).then((function(e){t.dispatcherDict=e.data}))},components:{NoAcceptPart:j}},E=M,$=(a("5bbb"),Object(d["a"])(E,y,k,!1,null,"39845d76",null)),A=$.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"info-table-wrapper"},[a("table",{staticClass:"info-table"},[t._m(0),t._v(" "),a("tr",[a("th",{attrs:{colspan:"8"}},[t._v(t._s(t.taskInfo.taskNo))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("急救单位：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"3"}},[t._v(t._s(t.taskInfo.departureHospital))]),t._v(" "),a("td",{staticClass:"key"},[t._v(" 受理时间：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dispatchTime))]),t._v(" "),a("td",{staticClass:"key"},[t._v("任务状态：")]),t._v(" "),a("td",{staticClass:"value"},[t._v("已拒绝")])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("调度人员：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dispatchEmpName))]),t._v(" "),a("td",{staticClass:"key"},[t._v(" 取消原因：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"7"}},[t._v(t._s(t.taskInfo.reason))])])])])},U=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}})])}],z={props:{taskInfo:{type:Object,default:function(){return{}}}},data:function(){return{carDict:[],carNo:null,doctorDict:[],nurseDict:[],driverDict:[],dispatcherDict:[],doctorList:[],nurseList:[],driverNo:null,dispatchEmpNo:null,phone:null}},methods:{getUserInfo:function(t,e){return e.find((function(e){return e.empNo==t}))},changeDriver:function(t){t&&(this.phone=this.getUserInfo(t,this.driverDict).phone)},mergeData:function(){var t=this,e=this.getUserInfo(this.driverNo,this.driverDict)||{},a=this.getUserInfo(this.dispatchEmpNo,this.dispatcherDict)||{};return{taskNo:this.$route.query.taskNo,carNo:this.carNo,driverNo:e.empNo,driverName:e.empName,dispatchEmpNo:a.empNo,dispatchEmpName:a.empName,driverPhone:this.phone,nurseList:this.nurseList.map((function(e){return t.getUserInfo(e,t.nurseDict)})),doctorList:this.doctorList.map((function(e){return t.getUserInfo(e,t.doctorDict)}))}}},created:function(){var t=this;Object(C["r"])().then((function(e){t.carDict=e.data.filter((function(t){return t.normal&&!t.inTask}))})),Object(C["m"])({userType:"doctor",inTask:!1,normal:!0}).then((function(e){t.doctorDict=e.data})),Object(C["m"])({userType:"nurse",inTask:!1,normal:!0}).then((function(e){t.nurseDict=e.data})),Object(C["m"])({userType:"driver",inTask:!1,normal:!0}).then((function(e){t.driverDict=e.data})),Object(C["m"])({userType:"dispatcher",inTask:!1,normal:!0}).then((function(e){t.dispatcherDict=e.data}))},components:{}},H=z,V=(a("31a8"),Object(d["a"])(H,R,U,!1,null,"16646f78",null)),F=V.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"info-table-wrapper"},[a("table",{staticClass:"info-table"},[t._m(0),t._v(" "),a("tr",[a("th",{attrs:{colspan:"8"}},[t._v(t._s(t.taskInfo.taskNo))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("急救单位：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"3"}},[t._v(t._s(t.taskInfo.departureHospital))]),t._v(" "),a("td",{staticClass:"key"},[t._v(" 受理时间：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dispatchTime))]),t._v(" "),a("td",{staticClass:"key"},[t._v("任务状态：")]),t._v(" "),a("td",{staticClass:"value"},[t._v("已受理")])]),t._v(" "),t._l(t.dispatchRecordList,(function(e,s){return["0"!==e.status?a("AcceptPart",{key:s,attrs:{item:e,index:s,carDict:t.carDict,doctorDict:t.doctorDict,nurseDict:t.nurseDict,driverDict:t.driverDict,dispatcherDict:t.dispatcherDict,savePart:t.savePart,onPrint:t.onPrint,openDispatchDetailModal:t.openDispatchDetailModal,cancelDispatch:t.cancelDispatch,delCar:t.delCar}}):a("NoAcceptPart",{key:s,attrs:{item:e,index:s,carDict:t.carDict,doctorDict:t.doctorDict,nurseDict:t.nurseDict,driverDict:t.driverDict,dispatcherDict:t.dispatcherDict,savePart:t.savePart,onPrint:t.onPrint,delPart:t.delPart,openDispatchDetailModal:t.openDispatchDetailModal,cancelDispatch:t.cancelDispatch,delCar:t.delCar}})]}))],2),t._v(" "),a("el-button",{staticClass:"add-car",attrs:{type:"primary",size:"small"},on:{click:t.addCar}},[t._v("新增车辆")]),t._v(" "),a("el-button",{staticClass:"user-info",attrs:{type:"text"},on:{click:t.openUserInfoModal}},[t._v("人员通讯录")]),t._v(" "),a("el-dialog",{attrs:{title:"人员通讯录",visible:t.dialogVisible,width:"600"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{label:"序号",width:"50",type:"index",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"carIndex",label:"车辆","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"post",label:"职务","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"电话","min-width":"100"}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)],1),t._v(" "),t.printData?a("div",{ref:"printable",staticClass:"print-table"},[a("div",{staticClass:"print-title"},[t._v(t._s(t.taskInfo.departureHospital)+"出车单")]),t._v(" "),a("div",{staticClass:"print-time"},[t._v(t._s(t.moment(t.taskInfo.dispatchTime).format("YYYY-MM-DD")))]),t._v(" "),a("table",{staticClass:"info-table"},[t._m(1),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("急救编号")]),t._v(" "),a("td",[t._v(t._s(t.taskInfo.taskNo))]),t._v(" "),a("td",{staticClass:"label"},[t._v("受理时间")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.taskInfo.dispatchTime))]),t._v(" "),a("td",{staticClass:"label"},[t._v("联系电话")]),t._v(" "),a("td",[t._v(t._s(t.printData.driverPhone))])]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("患者姓名")]),t._v(" "),a("td",[t._v(t._s(t.taskInfo.patientName)+"}}")]),t._v(" "),a("td",{staticClass:"label"},[t._v("患者性别")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.taskInfo.sex))]),t._v(" "),a("td",{staticClass:"label"},[t._v("患者年龄")]),t._v(" "),a("td",[t._v(t._s(t.taskInfo.age))])]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("身份证号")]),t._v(" "),a("td",[t._v("无名氏")]),t._v(" "),a("td",{staticClass:"label"},[t._v("求救类型")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.taskInfo.eventType))]),t._v(" "),a("td",{staticClass:"label"},[t._v("求救方式")]),t._v(" "),a("td",[t._v(t._s(t.taskInfo.askHelpType))])]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("地址")]),t._v(" "),a("td",{attrs:{colspan:"4"}},[t._v(t._s(t.taskInfo.eventLocation))]),t._v(" "),a("td",{staticClass:"label"},[t._v("呼救区域")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("出车单位")]),t._v(" "),a("td",{attrs:{colspan:"4"}},[t._v(t._s(t.taskInfo.departureHospital))]),t._v(" "),a("td",{staticClass:"label"},[t._v("呼救区域")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("主诉")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.taskInfo.complaints))]),t._v(" "),a("td",{staticClass:"label"},[t._v("初步诊断")]),t._v(" "),a("td",{attrs:{colspan:"3"}})]),t._v(" "),t._m(2),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("送往医院")]),t._v(" "),a("td",{attrs:{colspan:"4"}},[t._v(t._s(t.printData.departureHospital))]),t._v(" "),a("td",{staticClass:"label"},[t._v("行驶里程")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("派单时间")]),t._v(" "),a("td",[t._v(t._s(t.printData.dispatchTime))]),t._v(" "),a("td",{staticClass:"label"},[t._v("出车时间")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.printData.carStartTime))]),t._v(" "),a("td",{staticClass:"label"},[t._v("抵达现场")]),t._v(" "),a("td",[t._v(t._s(t.printData.arrivedPlaceTime))])]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("病人上车")]),t._v(" "),a("td"),t._v(" "),a("td",{staticClass:"label"},[t._v("到院时间")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.printData.arrivedHospitalTime))]),t._v(" "),a("td",{staticClass:"label"},[t._v("完成时间")]),t._v(" "),a("td",[t._v(t._s(t.printData.eventTime))])]),t._v(" "),t._m(3)])]):t._e(),t._v(" "),a("DispatchDetailModal",{ref:"DispatchDetailModal"})],1)},q=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"140"}}),t._v(" "),a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"140"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{staticClass:"label"},[t._v("处理结果")]),t._v(" "),a("td",{attrs:{colspan:"2"}}),t._v(" "),a("td",{staticClass:"label"},[t._v("空诊原因")]),t._v(" "),a("td",{attrs:{colspan:"3"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{staticClass:"label"},[t._v("备注")]),t._v(" "),a("td",{staticStyle:{height:"100px"},attrs:{colspan:"6"}})])}],G=a("de52"),Y=a.n(G),X=a("d4b2"),J=a.n(X),W=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tbody",[s("tr",{key:t.index},[s("td",{staticClass:"key carName"},[t._v("车辆"+t._s(t.index+1)+"：\n      "),t.item.abnormalMessage?s("el-popover",{attrs:{placement:"right-start",title:"突发状况",width:"120",trigger:"hover",content:t.item.abnormalMessage.title,"popper-class":"car-waring-popover"}},[s("img",{staticClass:"warning-icon",attrs:{slot:"reference",src:a("e2e7"),alt:""},slot:"reference"})]):t._e(),t._v(" "),0!==t.index&&"0"===t.item.status?s("i",{staticClass:"el-icon-close",on:{click:function(e){return t.delCar(t.item,t.index)}}}):t._e()],1),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.carNo))]):s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.item.carNo,callback:function(e){t.$set(t.item,"carNo",e)},expression:"item.carNo"}},t._l(t.carDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.carNo,label:t.carNo}})})),1)],1),t._v(" "),s("td",{staticClass:"key"},[t._v("车内电话：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.driverPhone))]):s("el-input",{attrs:{size:"mini"},model:{value:t.item.driverPhone,callback:function(e){t.$set(t.item,"driverPhone",e)},expression:"item.driverPhone"}})],1),t._v(" "),s("td",{staticClass:"key"},[t._v("司机：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.driverName))]):s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.item.driverName,callback:function(e){t.$set(t.item,"driverName",e)},expression:"item.driverName"}},t._l(t.driverAllDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.empNo,label:t.empName}})})),1)],1),t._v(" "),s("td",{staticClass:"key"},[t._v("调度员：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.dispatchEmpName))]):s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.item.dispatchEmpNo,callback:function(e){t.$set(t.item,"dispatchEmpNo",e)},expression:"item.dispatchEmpNo"}},t._l(t.dispatcherDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.empNo,label:t.empName}})})),1)],1)]),t._v(" "),s("tr",{key:t.index+"two"},[s("td",{staticClass:"key"},[t._v("出诊医生：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"2"}},["view"==t.item.mode?s("span",[t._v(t._s(t.item.doctorList.map((function(t){return t.empName})).join("，")))]):s("el-select",{staticClass:"block-select",attrs:{placeholder:"请选择",size:"mini",multiple:""},model:{value:t.item.doctorNoList,callback:function(e){t.$set(t.item,"doctorNoList",e)},expression:"item.doctorNoList"}},t._l(t.doctorAllDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.empNo,label:t.empName}})})),1)],1),t._v(" "),s("td",{staticClass:"key"},[t._v("出诊护士：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"2"}},["view"==t.item.mode?s("span",[t._v(t._s(t.item.nurseList.map((function(t){return t.empName})).join("，")))]):s("el-select",{staticClass:"block-select",attrs:{placeholder:"请选择",size:"mini",multiple:""},model:{value:t.item.nurseNoList,callback:function(e){t.$set(t.item,"nurseNoList",e)},expression:"item.nurseNoList"}},t._l(t.nurseAllDict,(function(t,e){return s("el-option",{key:e,attrs:{value:t.empNo,label:t.empName}})})),1)],1),t._v(" "),s("td",{staticClass:"key"},[t._v("患者数量：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.patientSize))]):s("el-input",{attrs:{size:"mini"},model:{value:t.item.patientSize,callback:function(e){t.$set(t.item,"patientSize",e)},expression:"item.patientSize"}})],1)]),t._v(" "),s("tr",{key:t.index+"three"},[s("td",{staticClass:"key"},[t._v("调度派单时间：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.dispatchTime)+" ")]):s("el-input",{attrs:{size:"mini"},model:{value:t.item.dispatchTime,callback:function(e){t.$set(t.item,"dispatchTime",e)},expression:"item.dispatchTime"}})],1),t._v(" "),s("td",{staticClass:"key"},[t._v("出车时间：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.eventTime))]):s("el-input",{attrs:{size:"mini"},model:{value:t.item.eventTime,callback:function(e){t.$set(t.item,"eventTime",e)},expression:"item.eventTime"}})],1),t._v(" "),s("td",{staticClass:"key"},[t._v("抵达现场时间：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.arrivedPlaceTime))]):s("el-input",{attrs:{size:"mini"},model:{value:t.item.arrivedPlaceTime,callback:function(e){t.$set(t.item,"arrivedPlaceTime",e)},expression:"item.arrivedPlaceTime"}})],1),t._v(" "),s("td",{staticClass:"key"},[t._v("任务完成时间：")]),t._v(" "),s("td",{staticClass:"value"},["view"==t.item.mode?s("span",[t._v(t._s(t.item.arrivedHospitalTime))]):s("el-input",{attrs:{size:"mini"},model:{value:t.item.arrivedHospitalTime,callback:function(e){t.$set(t.item,"arrivedHospitalTime",e)},expression:"item.arrivedHospitalTime"}})],1)]),t._v(" "),s("tr",{key:t.index+"four"},[s("td",{staticClass:"key"},[t._v("状态：")]),t._v(" "),s("td",{staticClass:"value",attrs:{colspan:"7"}},[s("div",{staticClass:"status-td"},["-1"==t.item.status?s("span",[t._v("已拒绝")]):"-2"==t.item.status?s("span",[t._v("已取消")]):s("span",[t._v(t._s(t.item.nodeName))]),t._v(" "),s("div",{staticClass:"block"}),t._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.onPrint(t.item)}}},[t._v("打印出车单")]),t._v(" "),"1"==t.item.status?s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.cancelDispatch(t.item,t.index)}}},[t._v("取消任务")]):t._e(),t._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.openDispatchDetailModal(t.item,t.index)}}},[t._v("进度跟踪")])],1)])])])},K=[],Q={props:{item:{type:Object,default:function(){return{}}},index:{type:Number,default:0},carDict:{type:Array,default:function(){return[]}},doctorDict:{type:Array,default:function(){return[]}},nurseDict:{type:Array,default:function(){return[]}},driverDict:{type:Array,default:function(){return[]}},dispatcherDict:{type:Array,default:function(){return[]}},savePart:{type:Function,default:function(){}},onPrint:{type:Function,default:function(){}},openDispatchDetailModal:{type:Function,default:function(){}},cancelDispatch:{type:Function,default:function(){}},delCar:{type:Function,default:function(){}}},data:function(){return{}},computed:{nurseAllDict:function(){for(var t=this,e=Object(g["a"])(this.nurseDict),a=function(a){e.find((function(e){return e.empNo==t.item.nurseList[a].empNo}))||e.push(t.item.nurseList[a])},s=0;s<this.item.nurseList.length;s++)a(s);return e},doctorAllDict:function(){for(var t=this,e=Object(g["a"])(this.doctorDict),a=function(a){e.find((function(e){return e.empNo==t.item.doctorList[a].empNo}))||e.push(t.item.doctorList[a])},s=0;s<this.item.doctorList.length;s++)a(s);return e},driverAllDict:function(){return this.item.driverDict}},watch:{driverDict:{handler:function(){var t=this;this.item.driverNo&&!this.driverDict.find((function(e){return e.empNo===t.item.driverNo}))?this.item.driverDict=[].concat(Object(g["a"])(this.driverDict),[{empName:this.item.driverName,empNo:this.item.driverNo}]):this.item.driverDict=Object(g["a"])(this.driverDict)},immediate:!0}},methods:{},components:{}},Z=Q,tt=(a("a8f1"),Object(d["a"])(Z,W,K,!1,null,"8a070ada",null)),et=tt.exports,at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"急救任务进度跟踪",visible:t.dialogVisible,width:"800"},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.dataSource?a("table",{staticClass:"info-table"},[a("colgroup",[a("col",{attrs:{width:"100"}}),t._v(" "),a("col",{attrs:{width:"100"}}),t._v(" "),a("col",{attrs:{width:"100"}}),t._v(" "),a("col",{attrs:{width:"60"}}),t._v(" "),a("col",{attrs:{width:"60"}}),t._v(" "),a("col",{attrs:{width:"100"}}),t._v(" "),a("col",{attrs:{width:"60"}}),t._v(" "),a("col",{attrs:{width:"60"}})]),t._v(" "),a("tr",[a("th",{attrs:{colspan:"8"}},[t._v("进度跟踪")])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("车辆"+t._s(t.index+1)+"：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.dataSource.carNo))]),t._v(" "),a("td",{staticClass:"key"},[t._v("车内电话：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"2"}},[t._v(t._s(t.dataSource.driverPhone))]),t._v(" "),a("td",{staticClass:"key"},[t._v("出诊医生：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"2"}},[t._v(t._s(t.dataSource.doctorList.map((function(t){return t.empName})).join("，")))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("调度派单时间：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.dataSource.dispatchTime))]),t._v(" "),a("td",{staticClass:"key"},[t._v("调度人员：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"2"}},[t._v(t._s(t.dataSource.dispatchEmpName))]),t._v(" "),a("td",{staticClass:"key"},[t._v("状态：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"2"}},[t._v(t._s(t.dataSource.nodeName))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("出车时间：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.dataSource.carStartTime))]),t._v(" "),a("td",{staticClass:"key"},[t._v("抵达现场时间：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"2"}},[t._v(t._s(t.dataSource.arrivedPlaceTime))]),t._v(" "),a("td",{staticClass:"key"},[t._v("任务完成时间：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"2"}},[t._v(t._s(t.dataSource.eventTime))])]),t._v(" "),t._l(t.dataSource.patientList,(function(e,s){return a("tbody",{key:s},[a("tr",[a("td",{staticClass:"key"},[t._v("病人"+t._s(s)+"：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(e.info.patientName))]),t._v(" "),a("td",{staticClass:"key"},[t._v("性别：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(e.info.sex))]),t._v(" "),a("td",{staticClass:"key"},[t._v("年龄：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(e.info.age))]),t._v(" "),a("td",{staticClass:"key"},[t._v("身份证号：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(e.info.idCard))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("院前病情转归：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"2"}},[t._v(t._s(e.measure&&e.measure.diseaseOutcome))]),t._v(" "),a("td",{staticClass:"key"},[t._v("初步诊断：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"4"}},[t._v(t._s(e.measure&&e.measure.diagnosis))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("送往医院：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.dataSource.departureHospital))]),t._v(" "),a("td",{staticClass:"key"},[t._v("主要病史：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.dataSource.eval&&t.dataSource.eval.medicalHistory))]),t._v(" "),a("td",{staticClass:"key"},[t._v("急救收费：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(e.info.totalPrice))]),t._v(" "),a("td",{staticClass:"key"},[t._v("危重等级：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(e.info.dangerLevel))])])])}))],2):t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)])},st=[],it={props:{},data:function(){return{dialogVisible:!1,dataSource:null,index:0}},methods:{open:function(t,e){var a=this;this.dialogVisible=!0,Object(C["q"])(t.dispatchId).then((function(t){a.dataSource=t.data,a.index=e}))}},components:{}},rt=it,nt=Object(d["a"])(rt,at,st,!1,null,"11f150ad",null),ct=nt.exports;function ot(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function lt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ot(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var dt={props:{taskInfo:{type:Object,default:function(){return{}}},dispatchRecordList:{type:Array,default:function(){return[]}},openSuccessModal:{type:Function}},data:function(){return{mode:"view",carDict:[],doctorDict:[],nurseDict:[],driverDict:[],dispatcherDict:[],dialogVisible:!1,printData:null,driverAllDict:[]}},computed:{tableData:function(){for(var t=this,e=[],a=function(a){var s=t.getUserInfo(t.dispatchRecordList[a].driverNo,t.driverAllDict);s&&e.push({carIndex:"车辆".concat(a+1),post:"司机",name:s.empName,phone:s.phone});var i=t.getUserInfo(t.dispatchRecordList[a].dispatchEmpNo,t.dispatcherDict);i&&e.push({carIndex:"车辆".concat(a+1),post:"调度员",name:i.empName,phone:i.phone}),e.push.apply(e,Object(g["a"])((t.dispatchRecordList[a].doctorList||[]).map((function(t){return{carIndex:"车辆".concat(a+1),post:"出诊医生",name:t.empName,phone:t.phone}})))),e.push.apply(e,Object(g["a"])((t.dispatchRecordList[a].nurseList||[]).map((function(t){return{carIndex:"车辆".concat(a+1),post:"出诊护士",name:t.empName,phone:t.phone}}))))},s=0;s<this.dispatchRecordList.length;s++)a(s);return e}},methods:{moment:Y.a,onPrint:function(t){var e=this;this.printData=t,this.$nextTick((function(){J()(e.$refs.printable,{direction:"vertical",injectGlobalCss:!0,scanStyles:!1,css:"\n          .print-table {\n            display: block !important;\n          }\n        "})}))},openUserInfoModal:function(){this.dialogVisible=!0},getUserInfo:function(t,e){return e.find((function(e){return e.empNo==t}))},addCar:function(){this.dispatchRecordList.push({taskNo:"",carNo:"",driverNo:"",driverName:"",driverPhone:"",nurseList:[],doctorList:[],doctorNoList:[],nurseNoList:[],mode:"edit",status:"0"})},delCar:function(t,e){var a=this;t.dispatchId?this.$confirm("是否删除此调度?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(C["g"])(t.dispatchId).then((function(t){a.openSuccessModal("删除此调度成功~")}))})):this.dispatchRecordList.splice(e,1)},mergeData:function(t){var e=this;console.log(t,"iyee");var a=this.getUserInfo(t.driverNo,t.driverDict)||{},s=this.getUserInfo(t.dispatchEmpNo,this.dispatcherDict)||{};return lt(lt({},t),{},{taskNo:this.$route.query.taskNo,carNo:t.carNo,driverNo:a.empNo,driverName:a.empName,dispatchEmpNo:s.empNo,dispatchEmpName:s.empName,driverPhone:t.driverPhone,nurseList:t.nurseNoList.map((function(a){return e.getUserInfo(a,[].concat(Object(g["a"])(e.nurseDict),Object(g["a"])(t.nurseList)))})),doctorList:t.doctorNoList.map((function(a){return e.getUserInfo(a,[].concat(Object(g["a"])(e.doctorDict),Object(g["a"])(t.doctorList)))}))})},savePart:function(t){var e=this,a=this.mergeData(t);t.dispatchId?Object(C["v"])(a).then((function(a){Object.assign(t,a.data),t.mode="view",e.openSuccessModal("已派单成功，等待车辆确认任务～")})):Object(C["a"])(a).then((function(t){e.openSuccessModal("新增车辆成功，等待车辆确认任务～")}))},delPart:function(t){var e=this;this.$confirm("是否删除此调度?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.dispatchRecordList.splice(t,1)}))},openDispatchDetailModal:function(t,e){this.$refs.DispatchDetailModal.open(t,e)},cancelDispatch:function(t,e){var a=this;this.$prompt("取消任务理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.abnormalMessage?t.abnormalMessage.title:""}).then((function(e){var s=e.value;s&&Object(C["d"])(t.dispatchId,s).then((function(t){a.$message.success("任务已取消，原因为：".concat(s)),a.$parent.init()}))}))}},created:function(){var t=this;Object(C["r"])().then((function(e){t.carDict=e.data.filter((function(t){return t.normal&&!t.inTask}))})),Object(C["m"])({userType:"doctor",inTask:!1,normal:!0}).then((function(e){t.doctorDict=e.data})),Object(C["m"])({userType:"nurse",inTask:!1,normal:!0}).then((function(e){t.nurseDict=e.data})),Object(C["m"])({userType:"driver",inTask:!1,normal:!0}).then((function(e){t.driverDict=e.data})),Object(C["m"])({userType:"driver"}).then((function(e){t.driverAllDict=e.data})),Object(C["m"])({userType:"dispatcher",inTask:!1,normal:!0}).then((function(e){t.dispatcherDict=e.data}))},components:{AcceptPart:et,NoAcceptPart:j,DispatchDetailModal:ct}},ut=dt,vt=(a("e8ee"),Object(d["a"])(ut,B,q,!1,null,"526d41cc",null)),pt=vt.exports,_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"info-table-wrapper"},[a("table",{staticClass:"info-table"},[t._m(0),t._v(" "),a("tr",[a("th",{attrs:{colspan:"8"}},[t._v(t._s(t.taskInfo.taskNo))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("急救单位：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"3"}},[t._v(t._s(t.taskInfo.departureHospital))]),t._v(" "),a("td",{staticClass:"key"},[t._v(" 受理时间：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dispatchTime))]),t._v(" "),a("td",{staticClass:"key"},[t._v("任务状态：")]),t._v(" "),a("td",{staticClass:"value"},[t._v("已完成")])]),t._v(" "),t._l(t.dispatchRecordList,(function(e,s){return["0"!==e.status?a("AcceptPart",{key:s,attrs:{item:e,index:s,carDict:t.carDict,doctorDict:t.doctorDict,nurseDict:t.nurseDict,driverDict:t.driverDict,dispatcherDict:t.dispatcherDict,savePart:t.savePart,onPrint:t.onPrint,openDispatchDetailModal:t.openDispatchDetailModal,cancelDispatch:t.cancelDispatch,delCar:t.delCar}}):a("NoAcceptPart",{key:s,attrs:{item:e,index:s,carDict:t.carDict,doctorDict:t.doctorDict,nurseDict:t.nurseDict,driverDict:t.driverDict,dispatcherDict:t.dispatcherDict,savePart:t.savePart,onPrint:t.onPrint,delPart:t.delPart,openDispatchDetailModal:t.openDispatchDetailModal,cancelDispatch:t.cancelDispatch,delCar:t.delCar}})]}))],2),t._v(" "),a("el-button",{staticClass:"user-info",attrs:{type:"text"},on:{click:t.openUserInfoModal}},[t._v("人员通讯录")]),t._v(" "),a("el-dialog",{attrs:{title:"人员通讯录",visible:t.dialogVisible,width:"600"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{label:"序号",width:"50",type:"index",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"carIndex",label:"车辆","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"post",label:"职务","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"电话","min-width":"100"}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)],1),t._v(" "),t.printData?a("div",{ref:"printable",staticClass:"print-table"},[a("div",{staticClass:"print-title"},[t._v(t._s(t.taskInfo.departureHospital)+"出车单")]),t._v(" "),a("div",{staticClass:"print-time"},[t._v(t._s(t.moment(t.taskInfo.dispatchTime).format("YYYY-MM-DD")))]),t._v(" "),a("table",{staticClass:"info-table"},[t._m(1),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("急救编号")]),t._v(" "),a("td",[t._v(t._s(t.taskInfo.taskNo))]),t._v(" "),a("td",{staticClass:"label"},[t._v("受理时间")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.taskInfo.dispatchTime))]),t._v(" "),a("td",{staticClass:"label"},[t._v("联系电话")]),t._v(" "),a("td",[t._v(t._s(t.printData.driverPhone))])]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("患者姓名")]),t._v(" "),a("td",[t._v(t._s(t.taskInfo.patientName)+"}}")]),t._v(" "),a("td",{staticClass:"label"},[t._v("患者性别")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.taskInfo.sex))]),t._v(" "),a("td",{staticClass:"label"},[t._v("患者年龄")]),t._v(" "),a("td",[t._v(t._s(t.taskInfo.age))])]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("身份证号")]),t._v(" "),a("td",[t._v("无名氏")]),t._v(" "),a("td",{staticClass:"label"},[t._v("求救类型")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.taskInfo.eventType))]),t._v(" "),a("td",{staticClass:"label"},[t._v("求救方式")]),t._v(" "),a("td",[t._v(t._s(t.taskInfo.askHelpType))])]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("地址")]),t._v(" "),a("td",{attrs:{colspan:"4"}},[t._v(t._s(t.taskInfo.eventLocation))]),t._v(" "),a("td",{staticClass:"label"},[t._v("呼救区域")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("出车单位")]),t._v(" "),a("td",{attrs:{colspan:"4"}},[t._v(t._s(t.taskInfo.departureHospital))]),t._v(" "),a("td",{staticClass:"label"},[t._v("呼救区域")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("主诉")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.taskInfo.complaints))]),t._v(" "),a("td",{staticClass:"label"},[t._v("初步诊断")]),t._v(" "),a("td",{attrs:{colspan:"3"}})]),t._v(" "),t._m(2),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("送往医院")]),t._v(" "),a("td",{attrs:{colspan:"4"}},[t._v(t._s(t.printData.departureHospital))]),t._v(" "),a("td",{staticClass:"label"},[t._v("行驶里程")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("派单时间")]),t._v(" "),a("td",[t._v(t._s(t.printData.dispatchTime))]),t._v(" "),a("td",{staticClass:"label"},[t._v("出车时间")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.printData.carStartTime))]),t._v(" "),a("td",{staticClass:"label"},[t._v("抵达现场")]),t._v(" "),a("td",[t._v(t._s(t.printData.arrivedPlaceTime))])]),t._v(" "),a("tr",[a("td",{staticClass:"label"},[t._v("病人上车")]),t._v(" "),a("td"),t._v(" "),a("td",{staticClass:"label"},[t._v("到院时间")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.printData.arrivedHospitalTime))]),t._v(" "),a("td",{staticClass:"label"},[t._v("完成时间")]),t._v(" "),a("td",[t._v(t._s(t.printData.eventTime))])]),t._v(" "),t._m(3)])]):t._e(),t._v(" "),a("DispatchDetailModal",{ref:"DispatchDetailModal"})],1)},ft=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"140"}}),t._v(" "),a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"90"}}),t._v(" "),a("col",{attrs:{width:"140"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{staticClass:"label"},[t._v("处理结果")]),t._v(" "),a("td",{attrs:{colspan:"2"}}),t._v(" "),a("td",{staticClass:"label"},[t._v("空诊原因")]),t._v(" "),a("td",{attrs:{colspan:"3"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{staticClass:"label"},[t._v("备注")]),t._v(" "),a("td",{staticStyle:{height:"100px"},attrs:{colspan:"6"}})])}];function mt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function ht(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?mt(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):mt(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var bt={props:{taskInfo:{type:Object,default:function(){return{}}},dispatchRecordList:{type:Array,default:function(){return[]}},openSuccessModal:{type:Function}},data:function(){return{mode:"view",carDict:[],doctorDict:[],nurseDict:[],driverDict:[],dispatcherDict:[],dialogVisible:!1,printData:null,driverAllDict:[]}},computed:{tableData:function(){for(var t=this,e=[],a=function(a){var s=t.getUserInfo(t.dispatchRecordList[a].driverNo,t.driverAllDict);s&&e.push({carIndex:"车辆".concat(a+1),post:"司机",name:s.empName,phone:s.phone});var i=t.getUserInfo(t.dispatchRecordList[a].dispatchEmpNo,t.dispatcherDict);i&&e.push({carIndex:"车辆".concat(a+1),post:"调度员",name:i.empName,phone:i.phone}),e.push.apply(e,Object(g["a"])((t.dispatchRecordList[a].doctorList||[]).map((function(t){return{carIndex:"车辆".concat(a+1),post:"出诊医生",name:t.empName,phone:t.phone}})))),e.push.apply(e,Object(g["a"])((t.dispatchRecordList[a].nurseList||[]).map((function(t){return{carIndex:"车辆".concat(a+1),post:"出诊护士",name:t.empName,phone:t.phone}}))))},s=0;s<this.dispatchRecordList.length;s++)a(s);return e}},methods:{moment:Y.a,onPrint:function(t){var e=this;this.printData=t,this.$nextTick((function(){J()(e.$refs.printable,{direction:"vertical",injectGlobalCss:!0,scanStyles:!1,css:"\n          .print-table {\n            display: block !important;\n          }\n        "})}))},openUserInfoModal:function(){this.dialogVisible=!0},getUserInfo:function(t,e){return e.find((function(e){return e.empNo==t}))},addCar:function(){this.dispatchRecordList.push({taskNo:"",carNo:"",driverNo:"",driverName:"",driverPhone:"",nurseList:[],doctorList:[],doctorNoList:[],nurseNoList:[],mode:"edit",status:"0"})},delCar:function(t,e){var a=this;t.dispatchId?this.$confirm("是否删除此调度?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(C["g"])(t.dispatchId).then((function(t){a.openSuccessModal("删除此调度成功~")}))})):this.dispatchRecordList.splice(e,1)},mergeData:function(t){var e=this;console.log(t,"iyee");var a=this.getUserInfo(t.driverNo,t.driverDict)||{},s=this.getUserInfo(t.dispatchEmpNo,this.dispatcherDict)||{};return ht(ht({},t),{},{taskNo:this.$route.query.taskNo,carNo:t.carNo,driverNo:a.empNo,driverName:a.empName,dispatchEmpNo:s.empNo,dispatchEmpName:s.empName,driverPhone:t.driverPhone,nurseList:t.nurseNoList.map((function(a){return e.getUserInfo(a,[].concat(Object(g["a"])(e.nurseDict),Object(g["a"])(t.nurseList)))})),doctorList:t.doctorNoList.map((function(a){return e.getUserInfo(a,[].concat(Object(g["a"])(e.doctorDict),Object(g["a"])(t.doctorList)))}))})},savePart:function(t){var e=this,a=this.mergeData(t);t.dispatchId?Object(C["v"])(a).then((function(a){Object.assign(t,a.data),t.mode="view",e.openSuccessModal("已派单成功，等待车辆确认任务～")})):Object(C["a"])(a).then((function(t){e.openSuccessModal("新增车辆成功，等待车辆确认任务～")}))},delPart:function(t){var e=this;this.$confirm("是否删除此调度?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.dispatchRecordList.splice(t,1)}))},openDispatchDetailModal:function(t,e){this.$refs.DispatchDetailModal.open(t,e)},cancelDispatch:function(t,e){var a=this;this.$prompt("取消任务理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.abnormalMessage?t.abnormalMessage.title:""}).then((function(e){var s=e.value;s&&Object(C["d"])(t.dispatchId,s).then((function(t){a.$message.success("任务已取消，原因为：".concat(s)),a.$parent.init()}))}))}},created:function(){var t=this;Object(C["r"])().then((function(e){t.carDict=e.data.filter((function(t){return t.normal&&!t.inTask}))})),Object(C["m"])({userType:"doctor",inTask:!1,normal:!0}).then((function(e){t.doctorDict=e.data})),Object(C["m"])({userType:"nurse",inTask:!1,normal:!0}).then((function(e){t.nurseDict=e.data})),Object(C["m"])({userType:"driver",inTask:!1,normal:!0}).then((function(e){t.driverDict=e.data})),Object(C["m"])({userType:"driver"}).then((function(e){t.driverAllDict=e.data})),Object(C["m"])({userType:"dispatcher",inTask:!1,normal:!0}).then((function(e){t.dispatcherDict=e.data}))},components:{AcceptPart:et,NoAcceptPart:j,DispatchDetailModal:ct}},yt=bt,kt=(a("806f"),Object(d["a"])(yt,_t,ft,!1,null,"3dea4c23",null)),Ct=kt.exports,Dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"info-table-wrapper"},[a("table",{staticClass:"info-table"},[t._m(0),t._v(" "),a("tr",[a("th",{attrs:{colspan:"8"}},[t._v(t._s(t.taskInfo.taskNo))])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("急救单位：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"3"}},[t._v(t._s(t.taskInfo.departureHospital))]),t._v(" "),a("td",{staticClass:"key"},[t._v(" 受理时间：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dispatchTime))]),t._v(" "),a("td",{staticClass:"key"},[t._v("任务状态：")]),t._v(" "),a("td",{staticClass:"value"},[t._v("已取消")])]),t._v(" "),a("tr",[a("td",{staticClass:"key"},[t._v("调度人员：")]),t._v(" "),a("td",{staticClass:"value"},[t._v(t._s(t.taskInfo.dispatchEmpName))]),t._v(" "),a("td",{staticClass:"key"},[t._v(" 拒绝原因：")]),t._v(" "),a("td",{staticClass:"value",attrs:{colspan:"7"}},[t._v(t._s(t.taskInfo.reason))])])])])},Nt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("colgroup",[a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}}),t._v(" "),a("col",{attrs:{width:"120px"}}),t._v(" "),a("col",{attrs:{width:"20%"}})])}],gt={props:{taskInfo:{type:Object,default:function(){return{}}}},data:function(){return{carDict:[],carNo:null,doctorDict:[],nurseDict:[],driverDict:[],dispatcherDict:[],doctorList:[],nurseList:[],driverNo:null,dispatchEmpNo:null,phone:null}},methods:{getUserInfo:function(t,e){return e.find((function(e){return e.empNo==t}))},changeDriver:function(t){t&&(this.phone=this.getUserInfo(t,this.driverDict).phone)},mergeData:function(){var t=this,e=this.getUserInfo(this.driverNo,this.driverDict)||{},a=this.getUserInfo(this.dispatchEmpNo,this.dispatcherDict)||{};return{taskNo:this.$route.query.taskNo,carNo:this.carNo,driverNo:e.empNo,driverName:e.empName,dispatchEmpNo:a.empNo,dispatchEmpName:a.empName,driverPhone:this.phone,nurseList:this.nurseList.map((function(e){return t.getUserInfo(e,t.nurseDict)})),doctorList:this.doctorList.map((function(e){return t.getUserInfo(e,t.doctorDict)}))}}},created:function(){var t=this;Object(C["r"])().then((function(e){t.carDict=e.data.filter((function(t){return t.normal&&!t.inTask}))})),Object(C["m"])({userType:"doctor",inTask:!1,normal:!0}).then((function(e){t.doctorDict=e.data})),Object(C["m"])({userType:"nurse",inTask:!1,normal:!0}).then((function(e){t.nurseDict=e.data})),Object(C["m"])({userType:"driver",inTask:!1,normal:!0}).then((function(e){t.driverDict=e.data})),Object(C["m"])({userType:"dispatcher",inTask:!1,normal:!0}).then((function(e){t.dispatcherDict=e.data}))},components:{}},wt=gt,It=(a("539d"),Object(d["a"])(wt,Dt,Nt,!1,null,"2a01074a",null)),Ot=It.exports,jt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-dialog",{attrs:{title:"",visible:t.dialogVisible,width:"425px","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("img",{staticClass:"success-img",attrs:{src:a("9857"),alt:""}}),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.title||"已派单成功，等待车辆确认任务～"))]),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:t.goList}},[t._v("返回列表")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.refresh}},[t._v("查看详情")])],1)])],1)},Tt=[],xt={props:{init:{type:Function}},data:function(){return{dialogVisible:!1,title:""}},methods:{open:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.title=t,this.dialogVisible=!0},close:function(){this.dialogVisible=!1},goList:function(){this.close(),this.$router.push("/desktop/index")},refresh:function(){this.close(),this.init&&this.init()}},components:{}},Lt=xt,Pt=(a("4c37"),Object(d["a"])(Lt,jt,Tt,!1,null,"6108c004",null)),St=Pt.exports;function Mt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function Et(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?Mt(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Mt(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var $t={props:{},data:function(){return{detail:{dispatchRecordList:[],taskInfo:{}},manageInfo:{cardList:[]}}},methods:{init:function(){var t=this;Object(C["i"])(this.$route.query.taskNo).then((function(e){t.detail={dispatchRecordList:[],taskInfo:{}},t.$nextTick((function(){t.detail=e.data,"0"===t.detail.taskInfo.status?t.detail.dispatchRecordList=[{taskNo:"",carNo:"",driverNo:"",driverName:"",driverPhone:"",nurseList:[],doctorList:[],doctorNoList:[],nurseNoList:[],driverDict:[],mode:"edit",status:"0"}]:t.detail.dispatchRecordList=t.detail.dispatchRecordList.map((function(t){return Et(Et({},t),{},{doctorNoList:t.doctorList.map((function(t){return t.empNo})),nurseNoList:t.nurseList.map((function(t){return t.empNo})),mode:"view",driverDict:[]})}))}))}))},reject:function(){var t=this;this.$prompt("拒绝理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var a=e.value;a&&Object(C["t"])(t.$route.query.taskNo,a).then((function(e){t.$refs.SuccessModal.open("拒绝成功")}))}))},submit:function(){var t=this,e=this.$refs.ManageTable.mergeData();Promise.all(e.map((function(t){return Object(C["a"])(t)}))).then((function(e){t.$refs.SuccessModal.open("已派单成功，等待车辆确认任务～")}))},archive:function(){var t=this;this.$confirm("是否确认归档?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(C["c"])(t.$route.query.taskNo).then((function(e){t.$refs.SuccessModal.open("归档成功")}))}))},openSuccessModal:function(t){this.$refs.SuccessModal.open(t)}},created:function(){this.init()},mounted:function(){},components:{DetailTablePersonal:v,DetailTableGroup:b,ManageTable:A,ManageTableReject:F,ManageTableAccept:pt,SuccessModal:St,ManageTableComplete:Ct,ManageTableCancel:Ot}},At=$t,Rt=(a("8d01"),Object(d["a"])(At,s,i,!1,null,"53fd374e",null));e["default"]=Rt.exports},9769:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},"9e37":function(t,e,a){},a8f1:function(t,e,a){"use strict";var s=a("bc8c"),i=a.n(s);i.a},bc8c:function(t,e,a){},c4b5:function(t,e,a){},c67e:function(t,e,a){},d4b2:function(t,e,a){"use strict";var s=this&&this.__awaiter||function(t,e,a,s){return new(a||(a=Promise))((function(i,r){function n(t){try{o(s.next(t))}catch(e){r(e)}}function c(t){try{o(s["throw"](t))}catch(e){r(e)}}function o(t){t.done?i(t.value):new a((function(e){e(t.value)})).then(n,c)}o((s=s.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var a,s,i,r,n={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(t){return function(e){return o([t,e])}}function o(r){if(a)throw new TypeError("Generator is already executing.");while(n)try{if(a=1,s&&(i=2&r[0]?s["return"]:r[0]?s["throw"]||((i=s["return"])&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return n.label++,{value:r[1],done:!1};case 5:n.label++,s=r[1],r=[0];continue;case 7:r=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){n=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){n.label=r[1];break}if(6===r[0]&&n.label<i[1]){n.label=i[1],i=r;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(r);break}i[2]&&n.ops.pop(),n.trys.pop();continue}r=e.call(t,n)}catch(c){r=[6,c],s=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=a("6b26"),n=["COLGROUP","COL"],c=["align-items","border","border-collapse","bottom","box-sizing","display","flex","float","font-family","font-size","font-weight","height","justify-content","left","line-height","margin","min-height","min-width","overflow","padding","position","right","text-align","text-overflow","top","vertical-align","white-space","width","word-break","word-wrap"];function o(t,e){void 0===e&&(e={}),e.log&&r.timeStart();var a=r.ensureArray(t).filter((function(t){return t&&t.parentNode})),s=a.map((function(t){return t.cloneNode(!0)})),i=e.direction||"vertical",o=void 0===e.scanStyles||("common"===e.scanStyles?c:e.scanStyles),l=a.map((function(t,e){var a=s[e];return t.parentNode.appendChild(a),r.loopStyles(a,o,n),t.parentNode.removeChild(a),a.outerHTML})),d=[];if(e.injectGlobalCss){var u=Array.from(document.styleSheets),v=u.map((function(t){var e="\n/* "+(t.href||"anonymous")+" */\n",a=Array.from(t.cssRules||t.rules||[]);return e+a.map((function(t){return t.cssText})).join("\n")})).join("\n");d.push({content:v})}"horizontal"===i&&d.push({content:"@page { size: landscape; }",media:"print"}),e.css&&d.push({content:e.css});var p='<div style="page-break-after: always;"></div>',_=l.join(p);return e.log&&r.timeEnd(),{styles:d,body:_}}function l(t,e){return void 0===e&&(e={}),s(this,void 0,void 0,(function(){var a,s,n,c,l;return i(this,(function(i){return a=window.open(),s=o(t,e),n=s.styles,c=s.body,r.injectStyles(a,n),a.document.body.innerHTML=c,l=e.beforePrint||r.noop,l(a),[2]}))}))}function d(t,e){return void 0===e&&(e={}),s(this,void 0,void 0,(function(){var a,s,n,c,l,d,u,v;return i(this,(function(i){switch(i.label){case 0:return a=document.createElement("iframe"),a.style.display="block",a.style.height="0",a.style.width="0",a.style.overflow="hidden",document.body.appendChild(a),s=a.contentWindow,n=a.contentDocument,c=o(t,e),l=c.styles,d=c.body,r.injectStyles(s,l),n.body.innerHTML=d,u=e.beforePrint||r.noop,u(s),v=Array.from(n.querySelectorAll("img[src]")),[4,Promise.all(v.map((function(t){return r.resolveImage(t)})))];case 1:return i.sent(),s.print(),document.body.removeChild(a),[2]}}))}))}e.generate=o,e.preview=l,e.print=d;var u=d;u.preview=l,e.default=u},e8ee:function(t,e,a){"use strict";var s=a("f260"),i=a.n(s);i.a},f260:function(t,e,a){},fe2a:function(t,e,a){},ff43:function(t,e,a){}}]);